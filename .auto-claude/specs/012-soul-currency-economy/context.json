{
  "task_description": "# Soul Currency & Economy\n\nImplement souls as the primary currency earned from slicing monsters, used for weapon purchases and upgrades.\n\n## Rationale\nEarning currency through gameplay (not IAPs) addresses competitor pain points about pay-to-win mechanics (pain-1-2, pain-4-1). Fair progression without monetization barriers.\n\n## User Stories\n- As a player, I want to earn currency through gameplay so that I can unlock upgrades without paying\n\n## Acceptance Criteria\n- [ ] Souls awarded per monster based on type and combo\n- [ ] Total souls displayed in HUD and menus\n- [ ] Souls persist between sessions\n- [ ] Level completion bonus souls awarded\n- [ ] Souls deducted on purchases with confirmation\n",
  "scoped_services": ["main"],
  "files_to_modify": [
    "src/scenes/GameplayScene.ts",
    "src/scenes/EndlessGameplayScene.ts",
    "src/scenes/LevelCompleteScene.ts",
    "src/scenes/ShopScene.ts",
    "src/managers/SaveManager.ts",
    "src/services/SupabaseService.ts"
  ],
  "files_to_reference": [
    "src/managers/SaveManager.ts",
    "src/managers/ShopManager.ts",
    "src/ui/HUD.ts",
    "src/systems/SlashSystem.ts",
    "src/config/constants.ts",
    "src/utils/EventBus.ts"
  ],
  "patterns": {
    "manager_pattern": "Singleton pattern with IManager interface (initialize, reset, shutdown)",
    "event_pattern": "EventBus.emit() for cross-scene communication",
    "persistence_pattern": "SaveManager uses localStorage, needs Supabase integration via SupabaseService",
    "hud_pattern": "HUD listens for 'souls-updated' event and calls updateSouls()"
  },
  "existing_implementations": {
    "description": "Soul currency infrastructure is 80% implemented. SaveManager has soul methods, HUD has display, SlashSystem emits events with souls, constants defined.",
    "relevant_files": [
      "src/managers/SaveManager.ts",
      "src/ui/HUD.ts",
      "src/systems/SlashSystem.ts",
      "src/config/constants.ts"
    ],
    "missing_pieces": [
      "Event listener to connect monster-sliced â†’ addSouls()",
      "Level completion bonus logic",
      "Supabase persistence",
      "Soul earn feedback animation"
    ]
  },
  "created_at": "2026-01-01T14:11:49.104563"
}
